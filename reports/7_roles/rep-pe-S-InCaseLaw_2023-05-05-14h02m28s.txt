RESULTS REPORT (PE S)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Evaluation: test set (5 random seeds)
Combination: S
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 02h44m49s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    1.444297  0.007487  1.103966 0.018877   0.6003  0.0198   0.5834  0.0064   0.5789   0.0105
  2    1.105613  0.008080  1.104950 0.017815   0.6163  0.0153   0.5911  0.0079   0.5880   0.0060
  3    0.973810  0.009094  1.106471 0.015026   0.6018  0.0056   0.6004  0.0076   0.5877   0.0066
  4    0.888793  0.006042  1.114558 0.025661   0.6126  0.0042   0.6040  0.0066   0.5974   0.0042

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
Argument: 1 
Statute: 2 
Precedent: 3 
RulingByLowerCourt: 4 
RulingByPresentCourt: 5 
RatioOfTheDecision: 6 
=> Iteration 0:
Epoch 1:
[[262  12   3   6  13   4  92]
 [ 14 214   2  26   4   0  56]
 [  6   2 126  10   0   0  57]
 [ 36   9  11 221   7   0 117]
 [ 31  10   3  10  24  13  31]
 [  1   1   0   1   0  23  11]
 [ 49  34  11 105   2   5 419]]
Epoch 2:
[[274  34   3   8  12   4  57]
 [ 11 242   1  15   2   0  45]
 [  2  10 122   6   0   0  61]
 [ 35  23   6 173   5   0 159]
 [ 30  21   2   7  24  12  26]
 [  1   1   0   0   0  24  11]
 [ 42  71   7  57   2   5 441]]
Epoch 3:
[[301  22   3   8  12   4  42]
 [ 18 236   2  17   2   1  40]
 [  9   7 125  10   0   1  49]
 [ 38  15   9 214   5   0 120]
 [ 41  13   2   8  22  15  21]
 [  1   1   0   1   0  27   7]
 [ 61  77  11  99   4  14 359]]
Epoch 4:
[[294  19   1   9  16   3  50]
 [ 18 227   1  18   3   1  48]
 [  9   4 124  10   0   1  53]
 [ 35  14   9 209   7   0 127]
 [ 36  11   2   8  28  12  25]
 [  1   1   0   0   0  26   9]
 [ 47  54  10  92   4  11 407]]
=> Iteration 1:
Epoch 1:
[[309   8   7   6   9   5  48]
 [ 29 215   4  29   0   1  38]
 [  9   6 136  13   0   0  37]
 [ 44  14  15 223   1   1 103]
 [ 48   9   3  19  13  12  18]
 [  2   1   0   0   0  24  10]
 [ 49  96  14  73   4  11 378]]
Epoch 2:
[[308  15   4   7  18   3  37]
 [ 21 229   1  36   3   0  26]
 [  8   7 131  13   0   0  42]
 [ 40  14   8 233   5   0 101]
 [ 32  14   1  26  24  11  14]
 [  1   1   0   0   3  23   9]
 [ 40  82   7  85  14   6 391]]
Epoch 3:
[[304  15   5   7  21   4  36]
 [ 24 229   3  28   3   2  27]
 [  5   6 145  11   0   1  33]
 [ 38  13  16 220   4   1 109]
 [ 34  16   2  15  28  13  14]
 [  1   1   0   0   0  25  10]
 [ 44  87  12  70  14  11 387]]
Epoch 4:
[[307  11   2   9  23   3  37]
 [ 23 226   3  29   3   1  31]
 [  6   4 140  15   0   0  36]
 [ 37  14  12 234   3   1 100]
 [ 34  12   1  20  25  12  18]
 [  1   1   0   0   0  25  10]
 [ 41  71   8  81  14  10 400]]
=> Iteration 2:
Epoch 1:
[[296  13   4  19   9   3  48]
 [ 21 227   3  32   3   0  30]
 [  7   3 133  17   0   0  41]
 [ 30   7  12 254  12   0  86]
 [ 29   3   5  22  28  12  23]
 [  1   1   0   1   0  23  11]
 [ 65 122  16 118   6   6 292]]
Epoch 2:
[[319   7   4   7  11   3  41]
 [ 23 229   7  25   1   0  31]
 [ 11   4 142  10   0   0  34]
 [ 39  12  16 218   5   1 110]
 [ 27   7   7  16  29  12  24]
 [  1   1   0   1   0  23  11]
 [ 78 104  22  69   6   6 340]]
Epoch 3:
[[289  20   3   9  13   3  55]
 [ 19 239   3  23   2   0  30]
 [ 10   6 125   8   1   0  51]
 [ 36  14  11 212   5   0 123]
 [ 25  11   4  12  31  14  25]
 [  1   1   0   0   0  24  11]
 [ 51 110   9  63  10   8 374]]
Epoch 4:
[[296  17   2  12  14   3  48]
 [ 21 241   2  23   2   0  27]
 [ 10   7 126  11   0   0  47]
 [ 35  16  10 222   5   0 113]
 [ 26  10   1  15  32  13  25]
 [  1   1   0   1   0  24  10]
 [ 55 118   8  77  11   7 349]]
=> Iteration 3:
Epoch 1:
[[293  16  14   8   4   3  54]
 [ 21 203   4  38   4   0  46]
 [  6   1 143   7   0   0  44]
 [ 34  11  13 223   6   1 113]
 [ 33   6   5  11  27  10  30]
 [  1   0   0   1   1  24  10]
 [ 39  27  24 142   4   5 384]]
Epoch 2:
[[310  12   4   6   2   3  55]
 [ 27 198   3  33   2   0  53]
 [  7   3 131   5   0   0  55]
 [ 35  14   8 203   5   2 134]
 [ 33   6   1  16  18  15  33]
 [  1   0   0   0   0  25  11]
 [ 40  26   7 104   4  11 433]]
Epoch 3:
[[305  17  12  10   6   3  39]
 [ 26 209   6  34   3   0  38]
 [  8   4 149  10   0   0  30]
 [ 35  15  14 226   4   0 107]
 [ 38   9   3  15  21  11  25]
 [  1   1   0   1   0  26   8]
 [ 48  43  19 129   7  11 368]]
Epoch 4:
[[292  31   9   8   8   3  41]
 [ 21 218   4  33   3   1  36]
 [  7   8 142  10   1   0  33]
 [ 34  18  13 222   5   0 109]
 [ 31  13   3  14  27  12  22]
 [  1   1   0   1   0  26   8]
 [ 39  53  14 114   5  11 389]]
=> Iteration 4:
Epoch 1:
[[248  25  10  11  36   6  56]
 [ 19 209   2  42   5   1  38]
 [  8   5 134  14   0   0  40]
 [ 29  14  10 236  12   2  98]
 [ 25  10   3  14  30  17  23]
 [  2   0   0   4   1  25   5]
 [ 36  68   8  87   9  13 404]]
Epoch 2:
[[266  43   8   4  22   4  45]
 [ 16 231   2  32   4   1  30]
 [  9   8 128  11   0   0  45]
 [ 33  19  10 225   7   1 106]
 [ 27  16   1  12  29  17  20]
 [  1   0   0   4   0  26   6]
 [ 31 113   7  76   6   8 384]]
Epoch 3:
[[299  31   9   5  12   4  32]
 [ 25 227   3  35   5   1  20]
 [  9   8 133  14   0   0  37]
 [ 38  16  10 243   5   0  89]
 [ 28  13   3  16  27  15  20]
 [  1   1   0   3   0  26   6]
 [ 47 114  11 100   8   8 337]]
Epoch 4:
[[300  24   7   5  13   4  39]
 [ 28 218   3  32   6   1  28]
 [ 10   8 132  13   0   0  38]
 [ 39  11  10 225   5   0 111]
 [ 29  11   2  15  29  16  20]
 [  1   0   0   2   0  26   8]
 [ 42  78   8  83  12   8 394]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.443868   1.093233   0.618935   0.573188    0.583705
Iteration 1    1.436172   1.092904   0.592112   0.580197    0.564322
Iteration 2    1.437599   1.100264   0.590820   0.583842    0.577627
Iteration 3    1.457065   1.141263   0.626733   0.591681    0.595659
Iteration 4    1.446782   1.092165   0.572805   0.588174    0.573173

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.116050   1.119359   0.632743   0.579166    0.584906
Iteration 1    1.100865   1.082002   0.612160   0.598161    0.598310
Iteration 2    1.100356   1.104615   0.608716   0.598842    0.591336
Iteration 3    1.114540   1.129549   0.634156   0.584484    0.583006
Iteration 4    1.096253   1.089222   0.593822   0.594615    0.582653

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.988895   1.115027   0.598112   0.593530    0.576644
Iteration 1    0.978393   1.083872   0.597930   0.613514    0.597178
Iteration 2    0.969677   1.108613   0.610022   0.592184    0.589541
Iteration 3    0.969726   1.127744   0.607011   0.601139    0.588981
Iteration 4    0.962358   1.097097   0.595966   0.601714    0.586146

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.896447   1.115504   0.619135   0.598554    0.595704
Iteration 1    0.892037   1.079440   0.611172   0.614144    0.605379
Iteration 2    0.888552   1.140514   0.612788   0.595369    0.593047
Iteration 3    0.888786   1.144657   0.613657   0.605896    0.596523
Iteration 4    0.878146   1.092678   0.606037   0.606257    0.596364

