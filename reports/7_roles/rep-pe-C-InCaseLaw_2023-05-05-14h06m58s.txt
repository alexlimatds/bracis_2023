RESULTS REPORT (PE C)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Evaluation: test set (5 random seeds)
Combination: C
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 02h45m41s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    1.339972  0.029338  1.023749 0.037262   0.6438  0.0121   0.5978  0.0122   0.5931   0.0106
  2    1.021761  0.016356  1.015934 0.048814   0.6374  0.0236   0.6061  0.0185   0.6041   0.0231
  3    0.899440  0.012307  1.019261 0.020871   0.6334  0.0150   0.6168  0.0058   0.6111   0.0063
  4    0.824905  0.011873  1.027777 0.019848   0.6320  0.0111   0.6192  0.0072   0.6136   0.0084

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
Argument: 1 
Statute: 2 
Precedent: 3 
RulingByLowerCourt: 4 
RulingByPresentCourt: 5 
RatioOfTheDecision: 6 
=> Iteration 0:
Epoch 1:
[[320   9   4   7   4   5  43]
 [ 19 221   2  24   1   0  49]
 [ 11   3 128  14   0   0  45]
 [ 38  11  12 222   5   1 112]
 [ 33   6   4  18  21  16  24]
 [  2   0   0   0   0  25  10]
 [ 51  36   9  78   3  12 436]]
Epoch 2:
[[314  15   5   5   8   3  42]
 [ 18 238   6  12   2   0  40]
 [ 11   5 130   8   0   0  47]
 [ 32  19  10 197   6   0 137]
 [ 34  10   5  13  28  12  20]
 [  1   0   0   0   1  24  11]
 [ 41  49  10  47   6  11 461]]
Epoch 3:
[[292  18   6   7  16   4  49]
 [ 18 227   4  18   2   1  46]
 [  8   4 131  11   1   0  46]
 [ 30  14   9 215   8   1 124]
 [ 29   7   4  13  33  12  24]
 [  1   0   0   0   0  25  11]
 [ 29  32  10  59  10  12 473]]
Epoch 4:
[[307  19   5   5  11   4  41]
 [ 18 232   5  18   1   1  41]
 [  7   5 132  11   2   0  44]
 [ 30  15  11 216   7   1 121]
 [ 33  12   4  12  30  14  17]
 [  1   0   0   0   0  26  10]
 [ 30  45  11  65   7  12 455]]
=> Iteration 1:
Epoch 1:
[[307   9   4   5   2   4  61]
 [ 32 209   2  25   1   0  47]
 [  7   3 136  15   0   0  40]
 [ 47  10  13 199   1   0 131]
 [ 40  12   1  19   8  11  31]
 [  2   0   0   0   0  23  12]
 [ 56  39   7  60   1   5 457]]
Epoch 2:
[[302  14   1   5   7   5  58]
 [ 25 215   1  26   1   0  48]
 [  8   3 129  16   1   1  43]
 [ 45   8  10 213   4   0 121]
 [ 32  12   0  13  24  17  24]
 [  1   0   0   0   0  25  11]
 [ 46  44   5  69   6  12 443]]
Epoch 3:
[[299  20   3   7   8   4  51]
 [ 17 233   1  27   0   0  38]
 [  6  10 137  11   1   1  35]
 [ 38  15  11 203   5   0 129]
 [ 29  21   1  14  26  14  17]
 [  1   2   0   1   0  26   7]
 [ 35  82   7  61   4  11 425]]
Epoch 4:
[[300  12   5   6  13   4  52]
 [ 22 222   3  25   1   1  42]
 [  6   3 142  13   1   1  35]
 [ 38  13  13 203   6   0 128]
 [ 28  14   6  11  29  15  19]
 [  1   1   0   1   0  26   8]
 [ 40  54  15  62   9  12 433]]
=> Iteration 2:
Epoch 1:
[[294  22   2   0  12   4  58]
 [ 18 236   1  23   3   0  35]
 [  6   5 127   7   0   0  56]
 [ 32  16   9 184   9   1 150]
 [ 32   6   4   9  32  13  26]
 [  2   0   0   3   0  24   8]
 [ 40  57   5  99   7   8 409]]
Epoch 2:
[[289  47   1   1   6   3  45]
 [ 15 254   1  26   3   0  17]
 [  7  21 133   8   1   0  31]
 [ 32  30  11 190   6   1 131]
 [ 34  15   2  17  21  12  21]
 [  2   1   0   3   0  24   7]
 [ 41 146   5 101   6   8 318]]
Epoch 3:
[[305  13   5   3  13   3  50]
 [ 23 225   2  33   3   0  30]
 [  7   8 142   7   2   0  35]
 [ 30  14  13 193   7   1 143]
 [ 32   5   6  16  28  12  23]
 [  1   0   0   3   0  26   7]
 [ 54  44   8  91   7  10 411]]
Epoch 4:
[[291  25   3   2  15   3  53]
 [ 19 236   1  26   3   0  31]
 [  7  10 139   6   1   0  38]
 [ 29  22  10 189   7   1 143]
 [ 32   8   4  12  30  11  25]
 [  1   1   0   3   0  26   6]
 [ 44  69   7  83   7   9 406]]
=> Iteration 3:
Epoch 1:
[[326   7   0   5   5   5  44]
 [ 31 220   3  23   1   0  38]
 [ 13   4 132   8   0   0  44]
 [ 54  12   9 182   1   2 141]
 [ 53   7   3  14  12  15  18]
 [  1   1   0   1   0  27   7]
 [ 64  28   5  48   2  13 465]]
Epoch 2:
[[306  15   0   6   9   3  53]
 [ 16 232   9  30   0   0  29]
 [  6   3 142  11   0   0  39]
 [ 37  16  11 208   4   0 125]
 [ 28  12   5  14  26  13  24]
 [  1   1   0   3   0  25   7]
 [ 39  50   8  70   3   7 448]]
Epoch 3:
[[322  11   0   6   8   3  42]
 [ 25 232   1  26   1   0  31]
 [  9   3 135  10   0   0  44]
 [ 42  18  10 196   3   0 132]
 [ 35  12   1  12  23  13  26]
 [  1   1   0   1   0  26   8]
 [ 51  59   6  60   3   8 438]]
Epoch 4:
[[307  11   1   8  13   3  49]
 [ 17 227   4  28   3   0  37]
 [  9   3 138  14   0   0  37]
 [ 35  15  11 216   6   0 118]
 [ 28   9   4  10  29  13  29]
 [  1   1   0   2   0  26   7]
 [ 41  42   6  72   7  10 447]]
=> Iteration 4:
Epoch 1:
[[314   6   0   5   1   5  61]
 [ 26 222   3  21   1   0  43]
 [  9   3 134  11   0   0  44]
 [ 37  16  11 216   6   0 115]
 [ 47   5   0  13  14  12  31]
 [  1   1   0   2   0  26   7]
 [ 47  28  11  59   4   9 467]]
Epoch 2:
[[300   7   3   7   7   3  65]
 [ 21 214   4  27   2   0  48]
 [  9   3 138  10   0   0  41]
 [ 30   9  12 204  11   0 135]
 [ 38   5   2  14  25  11  27]
 [  1   0   0   1   0  26   9]
 [ 22  19  12  50  12   8 502]]
Epoch 3:
[[298  18   5   8  14   3  46]
 [ 19 235   3  28   2   1  28]
 [  9   9 136  14   0   1  32]
 [ 29  15  14 241  11   0  91]
 [ 36  10   1  12  26  13  24]
 [  2   1   0   2   0  26   6]
 [ 31  49  10  84  17  11 423]]
Epoch 4:
[[297  14   3   7   7   3  61]
 [ 17 233   2  23   2   1  38]
 [  8   8 133  10   0   0  42]
 [ 30  16  10 217   9   0 119]
 [ 39   8   0  11  24  13  27]
 [  1   1   0   2   0  26   7]
 [ 25  42   9  64  13   9 463]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.333935   1.000472   0.644601   0.607362    0.600627
Iteration 1    1.345203   1.032967   0.650537   0.576547    0.576549
Iteration 2    1.393377   1.071734   0.620981   0.593268    0.595522
Iteration 3    1.312220   1.048245   0.646756   0.601501    0.586485
Iteration 4    1.315124   0.965329   0.656099   0.610504    0.606412

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.014860   0.997529   0.646211   0.615426    0.614632
Iteration 1    1.026898   1.017184   0.636818   0.600707    0.597273
Iteration 2    1.051361   1.107511   0.592420   0.572304    0.562208
Iteration 3    1.007917   0.993180   0.655613   0.620793    0.620775
Iteration 4    1.007771   0.964268   0.655904   0.621234    0.625839

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.895856   1.000281   0.638770   0.622017    0.620169
Iteration 1    0.904830   1.037900   0.636469   0.611963    0.604364
Iteration 2    0.920637   1.044047   0.617458   0.609666    0.603658
Iteration 3    0.888805   1.023728   0.657103   0.615436    0.613610
Iteration 4    0.887071   0.990347   0.617051   0.624872    0.613570

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.827040   1.011935   0.637700   0.627045    0.618964
Iteration 1    0.832910   1.035290   0.617975   0.616250    0.604590
Iteration 2    0.841536   1.063609   0.619278   0.607179    0.602897
Iteration 3    0.810721   1.014357   0.644848   0.626049    0.623989
Iteration 4    0.812320   1.013696   0.640094   0.619723    0.617663

