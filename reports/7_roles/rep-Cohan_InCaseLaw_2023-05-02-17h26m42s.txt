RESULTS REPORT
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Chunk layout: Cohan
Evaluation: test set (5 random seeds)
Max sequence length: 512
Max sentence length: 85
Max sentences per chunk: 7
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h32m43s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    1.329353  0.048242  0.884189 0.048721   0.6714  0.0503   0.5818  0.0274   0.5847   0.0159
  2    0.918145  0.023735  0.835256 0.025122   0.6813  0.0209   0.6309  0.0151   0.6365   0.0035
  3    0.796821  0.016298  0.825167 0.024746   0.6795  0.0204   0.6373  0.0127   0.6359   0.0139
  4    0.736110  0.018521  0.852635 0.030841   0.6777  0.0190   0.6340  0.0116   0.6375   0.0113

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
Argument: 1 
Statute: 2 
Precedent: 3 
RulingByLowerCourt: 4 
RulingByPresentCourt: 5 
RatioOfTheDecision: 6 
=> Iteration 0:
Epoch 1:
[[323  18   5   5   2   0  39]
 [  9 266  18  11   0   0  12]
 [  0   3 145   5   0   0  48]
 [ 29  22  10 260   0   4  76]
 [ 63   5   1  20   3   6  24]
 [  1   1   1   0   0  24  10]
 [ 23  21  18 121   0  16 426]]
Epoch 2:
[[321  18   1   6   8   0  38]
 [  5 283   6  15   0   0   7]
 [  0  14 119   5   0   0  63]
 [ 36  15   2 260   0   4  84]
 [ 61   5   0  31  18   0   7]
 [  1   3   0   0   0  24   9]
 [ 12  37   6 103   0  16 451]]
Epoch 3:
[[315  23   1   8   2   2  41]
 [  4 283   6  16   0   0   7]
 [  0  14 119   9   0   0  59]
 [ 36  14   2 271   0   4  74]
 [ 53   5   0  31   8  11  14]
 [  1   3   0   0   0  24   9]
 [ 12  38   6 107   0  16 446]]
Epoch 4:
[[313  23   1   5   8   4  38]
 [  4 279   9  12   0   0  12]
 [  0   9 124   5   0   0  63]
 [ 36  14   2 228   7   4 110]
 [ 50   5   0  26  18  16   7]
 [  1   2   0   0   0  24  10]
 [  8  22   9  77   4  16 489]]
=> Iteration 1:
Epoch 1:
[[327  22   3   6   7   0  27]
 [  8 265  11  12   4   0  16]
 [  0   2 145   6   0   0  48]
 [ 29  15   8 257   3   0  89]
 [ 60   9   0  10  25   0  18]
 [  3   1   0  10   6   4  13]
 [ 10  28  15 113   8   0 451]]
Epoch 2:
[[333  16   1   5   2   2  33]
 [ 10 260  12  16   0   0  18]
 [  6   2 138   6   2   0  47]
 [ 36   8   2 272   0   0  83]
 [ 64   5   0  16  21   5  11]
 [  3   1   1   5   0  16  11]
 [ 29  18  15 106   5   5 447]]
Epoch 3:
[[320  23   1   5   6   4  33]
 [  3 279  10   5   1   0  18]
 [  6   6 135   5   2   0  47]
 [ 36  14   2 251   7   1  90]
 [ 52   9   0  16  28  10   7]
 [  1   1   1   3   0  21  10]
 [  8  24  15 101   9  15 453]]
Epoch 4:
[[320  23   1   6   6   4  32]
 [  3 279   8   5   1   0  20]
 [  2   6 132   5   2   0  54]
 [ 36  14   2 256   0   1  92]
 [ 52   9   0  19  28  10   4]
 [  1   1   1   3   0  21  10]
 [  8  28  13  91   5  15 465]]
=> Iteration 2:
Epoch 1:
[[336  17   5   5   0   0  29]
 [  9 265  13  12   0   0  17]
 [  0   2 139   5   0   0  55]
 [ 36   8   9 231   0   0 117]
 [ 72   5   1  14   0   0  30]
 [  1   1   2   3   0   5  25]
 [ 19  10  16  71   0   4 505]]
Epoch 2:
[[318  17   3   6  18   0  30]
 [  3 278  11   5   2   0  17]
 [  0   6 134   5   3   0  53]
 [ 29  14   2 208  14   0 134]
 [ 52   5   0  19  22   0  24]
 [  1   1   2   3   0  15  15]
 [ 15  17  11  56   6   7 513]]
Epoch 3:
[[318  23   1   8  12   0  30]
 [  3 279  10   6   1   0  17]
 [  0   5 125   7   3   0  61]
 [ 36   8   2 263   0   0  92]
 [ 52   5   0  30  22   0  13]
 [  1   1   1   5   0  18  11]
 [ 15  17   6 102   6   7 472]]
Epoch 4:
[[324  17   1   8  12   0  30]
 [  4 278  10   6   1   0  17]
 [  0   6 127   5   3   0  60]
 [ 36  14   2 247   7   0  95]
 [ 52   5   0  30  29   0   6]
 [  1   1   1   3   0  15  16]
 [ 15  17   9  76   6   7 495]]
=> Iteration 3:
Epoch 1:
[[297  28   1   6   4   0  56]
 [  3 284   0   4   1   0  24]
 [  0  11 105   5   0   0  80]
 [ 29  22   0 226   0   0 124]
 [ 40   9   0  19  12   0  42]
 [  1   1   0   3   0   8  24]
 [  8  52   2  64   0   4 495]]
Epoch 2:
[[330   9   3   8  14   2  26]
 [  9 286   4   8   3   0   6]
 [  0  11 139   6   1   0  44]
 [ 36  15   2 252   7   0  89]
 [ 46   5   0  36  23  11   1]
 [  3   1   1   5   0  16  11]
 [ 25  28  15 116   4   5 432]]
Epoch 3:
[[315  17   3   9  12   4  32]
 [  4 276  12   9   1   0  14]
 [  0   2 141   5   1   0  52]
 [ 36   8   8 223   7   0 119]
 [ 41   5   0  32  27  16   1]
 [  1   1   1   3   0  16  15]
 [ 23  21  15  58   3   5 500]]
Epoch 4:
[[309  16   3   9   6   4  45]
 [  4 276   7   9   1   0  19]
 [  0   5 130   5   0   0  61]
 [ 36  14   2 223   7   0 119]
 [ 41   5   0  36  22  16   2]
 [  1   1   1   3   0  16  15]
 [ 23  14   8  53   0   5 522]]
=> Iteration 4:
Epoch 1:
[[324  28   3   2   6   0  29]
 [  4 279  17   4   2   0  10]
 [  0   6 139   4   0   0  52]
 [ 42  22   2 192   0   2 141]
 [ 61   9   0  10   6   6  30]
 [  1   2   0   3   0  17  14]
 [ 15  64  10  54   3   5 474]]
Epoch 2:
[[336  12   3   2  10   4  25]
 [  5 278  16   4   3   0  10]
 [  0   6 133   5   0   0  57]
 [ 37  15   2 219   7   7 114]
 [ 54   9   0  10  20  16  13]
 [  1   1   1   0   0  25   9]
 [ 21  22  14  49   7   9 503]]
Epoch 3:
[[334  11   5   4  10   4  24]
 [  5 277  16   4   1   0  13]
 [  0   6 134   5   0   0  56]
 [ 37  10   6 228   7   7 106]
 [ 46   9   1  10  21  16  19]
 [  1   1   1   0   0  25   9]
 [ 18  23  15  57   4   9 499]]
Epoch 4:
[[329  10   3   7  10   2  31]
 [  8 274  16   4   1   0  13]
 [  0   5 133   5   0   0  58]
 [ 36   8   8 241   7   4  97]
 [ 41   9   0  27  15  11  19]
 [  1   1   1   0   0  23  11]
 [ 12  23  10  70   4   9 497]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.315625   0.863419   0.658850   0.627195    0.602687
Iteration 1    1.393311   0.907977   0.727654   0.581387    0.594846
Iteration 2    1.269473   0.806602   0.600597   0.558070    0.558052
Iteration 3    1.291022   0.889288   0.729315   0.549849    0.575742
Iteration 4    1.377337   0.953657   0.640507   0.592404    0.592091

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.916411   0.840655   0.702878   0.638951    0.639516
Iteration 1    0.945931   0.862702   0.706458   0.622416    0.638158
Iteration 2    0.880922   0.795414   0.681004   0.611839    0.633466
Iteration 3    0.906502   0.819248   0.656443   0.625575    0.631412
Iteration 4    0.940961   0.858264   0.659831   0.655589    0.640073

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.796666   0.859909   0.700192   0.627831    0.610425
Iteration 1    0.817965   0.805077   0.662404   0.645527    0.641968
Iteration 2    0.771187   0.800208   0.708373   0.627700    0.650633
Iteration 3    0.788820   0.810634   0.661328   0.626905    0.633141
Iteration 4    0.809468   0.850008   0.665419   0.658582    0.643437

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.734152   0.859527   0.654454   0.635066    0.622421
Iteration 1    0.756145   0.832342   0.686325   0.647919    0.647648
Iteration 2    0.706238   0.805475   0.706870   0.627027    0.652016
Iteration 3    0.728816   0.893836   0.681275   0.616074    0.627470
Iteration 4    0.755199   0.871995   0.659819   0.644119    0.637785

