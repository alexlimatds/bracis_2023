RESULTS REPORT - DFCSC-CLS
Model: Longformer
Encoder: allenai/longformer-base-4096
Dataset: facts
Evaluation: test set (5 random seeds)
Max sequence length: 1024
Min context length: 250
Batch size: 4
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h48m18s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    1.034656  0.029139  0.745776 0.047747   0.5648  0.0684   0.5156  0.0582   0.5009   0.0783
  2    0.778250  0.033643  0.622464 0.029022   0.7373  0.0320   0.6546  0.0261   0.6699   0.0289
  3    0.647051  0.033824  0.614768 0.019742   0.7133  0.0246   0.6982  0.0205   0.7024   0.0154
  4    0.562193  0.021716  0.595065 0.026832   0.7146  0.0155   0.7035  0.0236   0.7070   0.0179

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[314   0  37  41]
 [  9   0  12  16]
 [  1   0 459 165]
 [ 96   0 312 735]]
Epoch 2:
[[222   0  38 132]
 [  1  20  12   4]
 [  0   2 512 111]
 [ 36   8 256 843]]
Epoch 3:
[[337   0  30  25]
 [  3  21  12   1]
 [  7   7 476 135]
 [133   8 193 809]]
Epoch 4:
[[305   0  37  50]
 [  1  22  12   2]
 [  1   4 503 117]
 [ 84   8 202 849]]
=> Iteration 1:
Epoch 1:
[[ 276    0    0  116]
 [   1    0    0   36]
 [   0    0    4  621]
 [  71    0    1 1071]]
Epoch 2:
[[266   0  68  58]
 [  1  16  14   6]
 [  0   2 526  97]
 [ 61   6 259 817]]
Epoch 3:
[[276   0  43  73]
 [  1  19   9   8]
 [  6   3 393 223]
 [ 64   6 123 950]]
Epoch 4:
[[297   0  43  52]
 [  1  20   8   8]
 [  8   4 372 241]
 [ 89   7 107 940]]
=> Iteration 2:
Epoch 1:
[[299   0  43  50]
 [  3   0  22  12]
 [  0   0 483 142]
 [ 88   0 261 794]]
Epoch 2:
[[309   0  29  54]
 [  4  14  11   8]
 [  0   3 397 225]
 [ 90   7 103 943]]
Epoch 3:
[[278   0  44  70]
 [  1  19  12   5]
 [  0   6 492 127]
 [ 60   7 214 862]]
Epoch 4:
[[302   0  39  51]
 [  1  19  10   7]
 [  0   6 475 144]
 [ 70   7 174 892]]
=> Iteration 3:
Epoch 1:
[[352   0   1  39]
 [  8   0   1  28]
 [ 17   0 145 463]
 [136   0  45 962]]
Epoch 2:
[[300   0  58  34]
 [  1   5  20  11]
 [  7   0 523  95]
 [ 90   0 275 778]]
Epoch 3:
[[314   0  49  29]
 [  1  20  12   4]
 [  9   2 473 141]
 [103   6 146 888]]
Epoch 4:
[[309   0  54  29]
 [  1  22  10   4]
 [  9   5 492 119]
 [ 99   9 186 849]]
=> Iteration 4:
Epoch 1:
[[272   0  35  85]
 [  1   7   8  21]
 [  0   0 428 197]
 [ 81   3 240 819]]
Epoch 2:
[[254   0  65  73]
 [  1  19  14   3]
 [  1   4 524  96]
 [ 71   7 246 819]]
Epoch 3:
[[309   0  35  48]
 [  1  21   8   7]
 [ 11   8 395 211]
 [114   9 148 872]]
Epoch 4:
[[293   0  44  55]
 [  1  18  13   5]
 [  9   7 437 172]
 [ 97   7 167 872]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.036822   0.744233   0.518850   0.544616    0.527173
Iteration 1    1.073976   0.791935   0.543477   0.411872    0.368938
Iteration 2    1.012355   0.674920   0.539823   0.557555    0.545014
Iteration 3    0.993335   0.803061   0.521535   0.492901    0.465757
Iteration 4    1.056793   0.714733   0.700069   0.571101    0.597748

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.801447   0.639278   0.730780   0.665900    0.685928
Iteration 1    0.767828   0.625170   0.729928   0.666847    0.684741
Iteration 2    0.744460   0.566547   0.712984   0.656716    0.678174
Iteration 3    0.746036   0.632526   0.799574   0.604477    0.612358
Iteration 4    0.831477   0.648798   0.713432   0.679102    0.688066

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.663741   0.606144   0.697229   0.724162    0.706647
Iteration 1    0.626290   0.624516   0.730859   0.669385    0.695768
Iteration 2    0.618610   0.582913   0.717407   0.691013    0.700481
Iteration 3    0.620452   0.618040   0.745349   0.718816    0.728130
Iteration 4    0.706164   0.642226   0.675824   0.687684    0.681052

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.570411   0.581268   0.732052   0.730059    0.728509
Iteration 1    0.549377   0.618375   0.714100   0.678948    0.693937
Iteration 2    0.544015   0.550968   0.724818   0.706081    0.713957
Iteration 3    0.545867   0.599640   0.715393   0.728211    0.719376
Iteration 4    0.601297   0.625075   0.686494   0.674010    0.679353

