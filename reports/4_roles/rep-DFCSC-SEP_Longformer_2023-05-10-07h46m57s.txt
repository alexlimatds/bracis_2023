RESULTS REPORT - DFCSC-SEP
Model: Longformer
Encoder: allenai/longformer-base-4096
Dataset: facts
Evaluation: test set (5 random seeds)
Max sequence length: 1024
Min context length: 250
Batch size: 4
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h47m37s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    1.031353  0.016461  0.762625 0.089243   0.5870  0.1122   0.5474  0.0703   0.5448   0.0890
  2    0.752216  0.018392  0.646771 0.026097   0.7109  0.0133   0.6773  0.0469   0.6755   0.0378
  3    0.622995  0.016863  0.614685 0.028150   0.7101  0.0136   0.7003  0.0276   0.6961   0.0172
  4    0.542032  0.013235  0.599552 0.028305   0.7147  0.0104   0.7134  0.0131   0.7122   0.0066

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[318   0  23  51]
 [  7   0   6  24]
 [  8   0 383 234]
 [111   0 190 842]]
Epoch 2:
[[351   0  25  16]
 [  1  21  10   5]
 [ 16   8 518  83]
 [149   8 229 757]]
Epoch 3:
[[314   0  25  53]
 [  1  20   4  12]
 [  3   8 286 328]
 [ 89   8  85 961]]
Epoch 4:
[[311   0  45  36]
 [  1  23  10   3]
 [  1   7 449 168]
 [ 98   9 140 896]]
=> Iteration 1:
Epoch 1:
[[203   0  42 147]
 [  1  14  11  11]
 [  1   0 480 144]
 [ 26   4 210 903]]
Epoch 2:
[[309   0  33  50]
 [  1  18  11   7]
 [  2   3 444 176]
 [ 88   6 148 901]]
Epoch 3:
[[288   0  32  72]
 [  1  18  11   7]
 [  2   5 422 196]
 [ 66   6 123 948]]
Epoch 4:
[[294   0  41  57]
 [  1  19  12   5]
 [  2   4 465 154]
 [ 70   6 175 892]]
=> Iteration 2:
Epoch 1:
[[366   0   9  17]
 [ 12   0   7  18]
 [148   0 169 308]
 [310   0  61 772]]
Epoch 2:
[[317   0  39  36]
 [  1  19  14   3]
 [  2   7 483 133]
 [100   6 226 811]]
Epoch 3:
[[311   0  62  19]
 [  1  20  15   1]
 [  1   6 556  62]
 [100   6 352 685]]
Epoch 4:
[[316   0  46  30]
 [  1  21  14   1]
 [  4   8 492 121]
 [ 92   8 216 827]]
=> Iteration 3:
Epoch 1:
[[211   0  64 117]
 [  1   0  13  23]
 [  0   0 319 306]
 [ 41   0 139 963]]
Epoch 2:
[[ 231    0   20  141]
 [   1   22    3   11]
 [   1    8  186  430]
 [  47    8   34 1054]]
Epoch 3:
[[320   0  29  43]
 [  1  22   8   6]
 [ 10   7 385 223]
 [ 77   9 112 945]]
Epoch 4:
[[307   0  50  35]
 [  1  21  11   4]
 [  9   4 418 194]
 [ 89   9 159 886]]
=> Iteration 4:
Epoch 1:
[[347   0  33  12]
 [  4  11  11  11]
 [  7   2 502 114]
 [140   6 337 660]]
Epoch 2:
[[357   0   7  28]
 [  1  20   3  13]
 [ 12   3 196 414]
 [146   8  22 967]]
Epoch 3:
[[336   0  46  10]
 [  1  21  12   3]
 [  2   8 570  45]
 [127   8 292 716]]
Epoch 4:
[[308   0  50  34]
 [  1  19  11   6]
 [  1   7 516 101]
 [ 96   8 172 867]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.044584   0.700338   0.520992   0.540171    0.529785
Iteration 1    1.034926   0.711969   0.762993   0.613565    0.657924
Iteration 2    1.001358   0.937618   0.454292   0.469872    0.416985
Iteration 3    1.028455   0.751948   0.528429   0.472796    0.489741
Iteration 4    1.047441   0.711250   0.668089   0.640782    0.629707

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.772763   0.657690   0.697025   0.738517    0.707913
Iteration 1    0.724969   0.611768   0.732953   0.693357    0.709600
Iteration 2    0.747148   0.619523   0.701849   0.701131    0.697729
Iteration 3    0.772795   0.673145   0.703408   0.600904    0.615321
Iteration 4    0.743403   0.671727   0.719175   0.652719    0.647032

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.629909   0.610301   0.687951   0.659983    0.665425
Iteration 1    0.627646   0.586111   0.730061   0.681444    0.702907
Iteration 2    0.605756   0.657132   0.708896   0.705702    0.690085
Iteration 3    0.648627   0.584645   0.715184   0.713423    0.712970
Iteration 4    0.603039   0.635236   0.708307   0.740783    0.708912

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.551882   0.590107   0.713992   0.729323    0.721341
Iteration 1    0.537170   0.601015   0.733078   0.696979    0.712153
Iteration 2    0.539430   0.601649   0.704516   0.721106    0.709626
Iteration 3    0.560146   0.646613   0.705189   0.698671    0.701567
Iteration 4    0.521532   0.558378   0.716620   0.720839    0.716092

