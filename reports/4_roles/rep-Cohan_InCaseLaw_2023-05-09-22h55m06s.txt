RESULTS REPORT - Cohan
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Chunk layout: Cohan
Evaluation: test set (5 random seeds)
Max sequence length: 512
Max sentence length: 85
Max sentences per chunk: 7
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h33m47s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    0.941257  0.034535  0.652870 0.030207   0.7140  0.0301   0.6068  0.0358   0.6287   0.0367
  2    0.697088  0.023937  0.625888 0.020023   0.6642  0.0222   0.6472  0.0134   0.6489   0.0197
  3    0.612480  0.020743  0.619035 0.024682   0.6842  0.0081   0.6574  0.0215   0.6679   0.0110
  4    0.560805  0.016381  0.621246 0.023431   0.6770  0.0167   0.6709  0.0148   0.6723   0.0113

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[295   0  51  46]
 [  1  14  11  11]
 [  8   1 427 189]
 [ 84   6 174 879]]
Epoch 2:
[[325   2   8  57]
 [  1  19   2  15]
 [ 19  11 211 384]
 [ 97  13  69 964]]
Epoch 3:
[[322   0  21  49]
 [  1  20   4  12]
 [ 19   9 398 199]
 [100  10 139 894]]
Epoch 4:
[[315   0  33  44]
 [  1  20   5  11]
 [  4   9 403 209]
 [ 93  10 129 911]]
=> Iteration 1:
Epoch 1:
[[287   0  29  76]
 [  1  14   9  13]
 [  0   8 353 264]
 [ 62   3 154 924]]
Epoch 2:
[[276   0  58  58]
 [  1  17   8  11]
 [  0   8 451 166]
 [ 63   5 209 866]]
Epoch 3:
[[288   0  51  53]
 [  1  17   8  11]
 [  0   8 360 257]
 [ 67   5 129 942]]
Epoch 4:
[[278   0  62  52]
 [  1  17   8  11]
 [  0   8 422 195]
 [ 74   5 154 910]]
=> Iteration 2:
Epoch 1:
[[321   0  17  54]
 [  1   4  15  17]
 [  8   0 300 317]
 [ 96   0 143 904]]
Epoch 2:
[[291   2  46  53]
 [  1  17   8  11]
 [  8  11 415 191]
 [ 78  16 166 883]]
Epoch 3:
[[297   0  36  59]
 [  1  12  13  11]
 [  8   1 427 189]
 [ 73   9 164 897]]
Epoch 4:
[[299   2  34  57]
 [  1  19   6  11]
 [  8  13 399 205]
 [ 76  18 139 910]]
=> Iteration 3:
Epoch 1:
[[309   0  36  47]
 [  1  10  16  10]
 [  8   5 476 136]
 [ 87   1 231 824]]
Epoch 2:
[[312   2  18  60]
 [  1  16   9  11]
 [ 22   5 354 244]
 [ 77  16 113 937]]
Epoch 3:
[[316   0  31  45]
 [  1  16  12   8]
 [ 19   5 406 195]
 [ 84  11 159 889]]
Epoch 4:
[[311   2  33  46]
 [  1  16  11   9]
 [ 19   5 386 215]
 [ 65  16 130 932]]
=> Iteration 4:
Epoch 1:
[[300   0   9  83]
 [  1  13   5  18]
 [  8   5 221 391]
 [ 90   3  68 982]]
Epoch 2:
[[293   0  39  60]
 [  1  16   9  11]
 [  8   5 349 263]
 [ 89   5 149 900]]
Epoch 3:
[[276   0  49  67]
 [  1  18   7  11]
 [  4   7 352 262]
 [ 76   7 141 919]]
Epoch 4:
[[292   0  43  57]
 [  1  18   7  11]
 [  4   7 373 241]
 [ 84   7 145 907]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.896643   0.626257   0.713088   0.645790    0.669336
Iteration 1    0.978086   0.634587   0.687819   0.620930    0.648063
Iteration 2    0.958402   0.700580   0.771198   0.549472    0.566981
Iteration 3    0.902821   0.626568   0.706333   0.635261    0.650898
Iteration 4    0.970331   0.676360   0.691629   0.582350    0.608395

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.680653   0.661948   0.640994   0.630897    0.614059
Iteration 1    0.714991   0.619148   0.696550   0.660699    0.675263
Iteration 2    0.695867   0.605773   0.642218   0.659584    0.649609
Iteration 3    0.663256   0.610993   0.658135   0.653631    0.653086
Iteration 4    0.730675   0.631581   0.683319   0.631421    0.652417

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.604868   0.601977   0.681052   0.695230    0.686876
Iteration 1    0.616139   0.656590   0.694608   0.648575    0.668592
Iteration 2    0.613869   0.601712   0.693059   0.637489    0.658161
Iteration 3    0.581554   0.594647   0.675507   0.666483    0.670119
Iteration 4    0.645973   0.640247   0.676680   0.639448    0.655894

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.556585   0.595109   0.689467   0.696484    0.692356
Iteration 1    0.562302   0.660978   0.696641   0.659998    0.676338
Iteration 2    0.555709   0.631313   0.650893   0.677705    0.660846
Iteration 3    0.539563   0.602273   0.665068   0.664699    0.664188
Iteration 4    0.589865   0.616556   0.682871   0.655428    0.667880

