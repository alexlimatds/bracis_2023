RESULTS REPORT (PE S)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: test set (5 random seeds)
Combination: S
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 02h51m45s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    1.058344  0.025211  0.796865 0.032368   0.5997  0.0146   0.6189  0.0239   0.6030   0.0213
  2    0.820211  0.010103  0.783651 0.026029   0.6048  0.0134   0.6558  0.0222   0.6210   0.0115
  3    0.722304  0.006465  0.787430 0.027757   0.6083  0.0094   0.6628  0.0104   0.6279   0.0092
  4    0.656913  0.006610  0.794282 0.020203   0.6177  0.0109   0.6558  0.0066   0.6314   0.0094

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[284   2  28  78]
 [  1  24   8   4]
 [ 75   7 351 192]
 [115  11 196 821]]
Epoch 2:
[[301   3  28  60]
 [  1  29   4   3]
 [ 80  15 322 208]
 [128  19 158 838]]
Epoch 3:
[[283   2  31  76]
 [  1  25   7   4]
 [ 55  11 336 223]
 [ 84  14 180 865]]
Epoch 4:
[[267   3  32  90]
 [  1  26   7   3]
 [ 50   9 314 252]
 [ 75  14 164 890]]
=> Iteration 1:
Epoch 1:
[[259   4  52  77]
 [  0  24   6   7]
 [ 20   7 304 294]
 [ 72  13 254 804]]
Epoch 2:
[[289   3  39  61]
 [  0  24   9   4]
 [ 36  11 300 278]
 [ 89  13 207 834]]
Epoch 3:
[[281   3  47  61]
 [  0  26   8   3]
 [ 23  12 344 246]
 [ 89  16 231 807]]
Epoch 4:
[[271   3  46  72]
 [  1  24   8   4]
 [ 25  10 327 263]
 [ 81  14 202 846]]
=> Iteration 2:
Epoch 1:
[[240   3  35 114]
 [  1  25   6   5]
 [ 51   6 210 358]
 [ 68  16 164 895]]
Epoch 2:
[[276   2  40  74]
 [  1  25   9   2]
 [ 49   7 266 303]
 [ 79  13 172 879]]
Epoch 3:
[[308   2  25  57]
 [  1  27   7   2]
 [ 76  11 266 272]
 [118  16 163 846]]
Epoch 4:
[[271   2  35  84]
 [  1  26   7   3]
 [ 38   9 296 282]
 [ 71  13 177 882]]
=> Iteration 3:
Epoch 1:
[[247   4  39 102]
 [  1  25   5   6]
 [ 40   9 197 379]
 [ 72  11 149 911]]
Epoch 2:
[[305   3  27  57]
 [  1  26   6   4]
 [ 67  12 224 322]
 [130  13 152 848]]
Epoch 3:
[[257   3  51  81]
 [  1  27   7   2]
 [ 28  12 329 256]
 [ 86  16 225 816]]
Epoch 4:
[[268   3  42  79]
 [  1  26   8   2]
 [ 33  12 280 300]
 [ 92  16 170 865]]
=> Iteration 4:
Epoch 1:
[[260   2  44  86]
 [  0  23   6   8]
 [ 30   4 217 374]
 [105  11 148 879]]
Epoch 2:
[[288   2  33  69]
 [  0  24   7   6]
 [ 40   6 250 329]
 [116  13 120 894]]
Epoch 3:
[[236   3  49 104]
 [  0  26   7   4]
 [ 24  10 331 260]
 [ 72  17 200 854]]
Epoch 4:
[[262   2  51  77]
 [  1  25   7   4]
 [ 30   8 331 256]
 [ 82  15 195 851]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.058807   0.733229   0.623795   0.663256    0.640635
Iteration 1    1.056270   0.802631   0.602900   0.624794    0.610855
Iteration 2    1.066252   0.819599   0.581256   0.601737    0.582147
Iteration 3    1.094510   0.817713   0.588272   0.604501    0.585882
Iteration 4    1.015883   0.811154   0.602170   0.600279    0.595368

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.819821   0.748990   0.603533   0.700000    0.635286
Iteration 1    0.812872   0.758996   0.604444   0.648888    0.622504
Iteration 2    0.820604   0.798354   0.614581   0.643597    0.624612
Iteration 3    0.838529   0.819503   0.581098   0.645268    0.600167
Iteration 4    0.809229   0.792411   0.620123   0.641374    0.622485

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.726176   0.741817   0.624220   0.672999    0.643711
Iteration 1    0.715161   0.769898   0.609914   0.668994    0.632870
Iteration 2    0.720304   0.814350   0.597563   0.670300    0.622024
Iteration 3    0.732848   0.812007   0.600113   0.656413    0.620828
Iteration 4    0.717030   0.799076   0.609467   0.645375    0.619869

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.657322   0.773187   0.626847   0.666219    0.640741
Iteration 1    0.652025   0.774885   0.615584   0.650833    0.629386
Iteration 2    0.659911   0.795290   0.627770   0.659821    0.638751
Iteration 3    0.667253   0.828840   0.597641   0.647789    0.614264
Iteration 4    0.648054   0.799208   0.620444   0.654544    0.633903

