RESULTS REPORT (PE C)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: test set (5 random seeds)
Combination: C
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 02h51m46s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    0.980245  0.027600  0.745381 0.052980   0.6149  0.0296   0.6344  0.0345   0.6186   0.0319
  2    0.763222  0.019897  0.729225 0.038124   0.6210  0.0263   0.6576  0.0253   0.6325   0.0250
  3    0.668989  0.018583  0.737447 0.032339   0.6236  0.0201   0.6590  0.0096   0.6348   0.0116
  4    0.610556  0.016678  0.750295 0.033934   0.6204  0.0167   0.6653  0.0158   0.6365   0.0169

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[280   2  18  92]
 [  0  22   8   7]
 [ 34   7 234 350]
 [ 84  12 121 926]]
Epoch 2:
[[311   2  35  44]
 [  1  25   7   4]
 [ 39   7 345 234]
 [114  12 201 816]]
Epoch 3:
[[269   2  29  92]
 [  1  24   7   5]
 [ 26   7 299 293]
 [ 75  13 143 912]]
Epoch 4:
[[285   2  31  74]
 [  1  25   7   4]
 [ 31   7 316 271]
 [ 85  16 163 879]]
=> Iteration 1:
Epoch 1:
[[253   3  23 113]
 [  1  22   7   7]
 [ 32   5 170 418]
 [ 74  13 168 888]]
Epoch 2:
[[268   2  24  98]
 [  1  25   8   3]
 [ 45  10 195 375]
 [ 89  14 140 900]]
Epoch 3:
[[275   2  40  75]
 [  1  26   8   2]
 [ 40  10 286 289]
 [ 89  14 209 831]]
Epoch 4:
[[263   3  33  93]
 [  1  27   7   2]
 [ 36  12 266 311]
 [ 78  17 185 863]]
=> Iteration 2:
Epoch 1:
[[278   6  42  66]
 [  1  25   7   4]
 [ 46  11 339 229]
 [ 87  19 244 793]]
Epoch 2:
[[288   3  35  66]
 [  1  25   8   3]
 [ 53  10 309 253]
 [ 89  14 221 819]]
Epoch 3:
[[273   3  42  74]
 [  1  26   7   3]
 [ 39  12 316 258]
 [ 82  18 201 842]]
Epoch 4:
[[274   3  40  75]
 [  1  25   8   3]
 [ 39  10 314 262]
 [ 83  16 192 852]]
=> Iteration 3:
Epoch 1:
[[272   2  35  83]
 [  1  24  10   2]
 [ 41   5 400 179]
 [ 82  15 251 795]]
Epoch 2:
[[278   3  41  70]
 [  1  25   7   4]
 [ 28  11 394 192]
 [102  17 206 818]]
Epoch 3:
[[291   2  24  75]
 [  1  25   8   3]
 [ 42  10 324 249]
 [ 96  17 154 876]]
Epoch 4:
[[272   2  31  87]
 [  1  24   8   4]
 [ 27   9 350 239]
 [ 80  17 186 860]]
=> Iteration 4:
Epoch 1:
[[281   1  43  67]
 [  2  22   8   5]
 [ 22   4 342 257]
 [ 74  11 204 854]]
Epoch 2:
[[246   2  52  92]
 [  1  25   4   7]
 [  7   8 302 308]
 [ 54  11 142 936]]
Epoch 3:
[[271   2  44  75]
 [  1  25   3   8]
 [ 22   8 280 315]
 [ 71  13 121 938]]
Epoch 4:
[[278   2  46  66]
 [  1  28   6   2]
 [ 30  10 337 248]
 [ 75  16 178 874]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.971758   0.725737   0.625693   0.623357    0.614893
Iteration 1    0.978760   0.842204   0.574771   0.572226    0.564147
Iteration 2    1.022610   0.752753   0.586794   0.655262    0.612686
Iteration 3    0.990649   0.721066   0.633507   0.669516    0.649085
Iteration 4    0.937449   0.685146   0.653782   0.651447    0.652409

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.745324   0.710788   0.635550   0.683738    0.656320
Iteration 1    0.762383   0.797116   0.585153   0.614688    0.587528
Iteration 2    0.797921   0.743737   0.601510   0.655326    0.623675
Iteration 3    0.768026   0.702801   0.622193   0.682730    0.646349
Iteration 4    0.742455   0.691684   0.660782   0.651331    0.648793

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.659502   0.726044   0.643198   0.652793    0.642899
Iteration 1    0.667077   0.795877   0.599988   0.647217    0.618585
Iteration 2    0.703640   0.745003   0.601375   0.660347    0.622987
Iteration 3    0.666366   0.718472   0.625795   0.675707    0.643802
Iteration 4    0.648363   0.701840   0.647599   0.658912    0.645719

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.599908   0.739667   0.633993   0.669336    0.646868
Iteration 1    0.612387   0.813356   0.593802   0.645320    0.609477
Iteration 2    0.640867   0.752840   0.608673   0.655616    0.626605
Iteration 3    0.607690   0.731468   0.627178   0.663733    0.641143
Iteration 4    0.591928   0.714141   0.638192   0.692449    0.658333

