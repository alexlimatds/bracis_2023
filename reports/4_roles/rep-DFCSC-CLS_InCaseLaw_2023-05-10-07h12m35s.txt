RESULTS REPORT - DFCSC-CLS
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: test set (5 random seeds)
Max sequence length: 512
Min context length: 250
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h34m16s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    0.935869  0.021320  0.640604 0.023640   0.5578  0.0175   0.5360  0.0253   0.5393   0.0187
  2    0.668744  0.015945  0.612235 0.023722   0.6442  0.0204   0.6079  0.0314   0.6174   0.0263
  3    0.572521  0.016480  0.609567 0.019481   0.6426  0.0141   0.6366  0.0143   0.6340   0.0076
  4    0.525422  0.013091  0.600230 0.015165   0.6475  0.0159   0.6526  0.0112   0.6479   0.0102

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[312   0  32  48]
 [  1   0  26  10]
 [  8   0 427 190]
 [114   0 137 892]]
Epoch 2:
[[273   0  50  69]
 [  1  11  15  10]
 [  0  12 448 165]
 [ 68   2 148 925]]
Epoch 3:
[[287   1  36  68]
 [  1  13   8  15]
 [  0  14 394 217]
 [ 68  17  73 985]]
Epoch 4:
[[288   1  41  62]
 [  1  13  13  10]
 [  0  14 414 197]
 [ 69  12 114 948]]
=> Iteration 1:
Epoch 1:
[[271   0  41  80]
 [  1   0  25  11]
 [  0   0 364 261]
 [ 71   0 137 935]]
Epoch 2:
[[293   0  49  50]
 [  1   7  21   8]
 [  0   7 446 172]
 [117   2 169 855]]
Epoch 3:
[[273   0  49  70]
 [  1  24   4   8]
 [  0  23 282 320]
 [ 84  20  81 958]]
Epoch 4:
[[280   1  49  62]
 [  1  18  12   6]
 [  0  21 426 178]
 [ 89  20 155 879]]
=> Iteration 2:
Epoch 1:
[[293   0  45  54]
 [  1   0  26  10]
 [  0   0 444 181]
 [ 74   0 179 890]]
Epoch 2:
[[319   0  31  42]
 [  1  11  18   7]
 [  0  13 473 139]
 [110   3 232 798]]
Epoch 3:
[[275   0  38  79]
 [  1  11  15  10]
 [  0  13 423 189]
 [ 60   3 180 900]]
Epoch 4:
[[290   0  38  64]
 [  1  14  16   6]
 [  0  13 431 181]
 [ 61   6 183 893]]
=> Iteration 3:
Epoch 1:
[[276   0  20  96]
 [  1   1   8  27]
 [  0   9 240 376]
 [ 78   2  73 990]]
Epoch 2:
[[269   0  36  87]
 [  1   5  12  19]
 [  0  10 349 266]
 [ 71   3 124 945]]
Epoch 3:
[[302   1  39  50]
 [  1  14  11  11]
 [  0  17 374 234]
 [ 80  14 141 908]]
Epoch 4:
[[302   1  39  50]
 [  1  14  11  11]
 [  0  17 379 229]
 [ 77  14 134 918]]
=> Iteration 4:
Epoch 1:
[[296   0  19  77]
 [  1   1  17  18]
 [  0   6 323 296]
 [ 82   0  87 974]]
Epoch 2:
[[303   1  48  40]
 [  1   7  26   3]
 [  0   9 509 107]
 [103   3 247 790]]
Epoch 3:
[[296   1  25  70]
 [  1  13  11  12]
 [  0  12 377 236]
 [ 90  11 118 924]]
Epoch 4:
[[291   1  35  65]
 [  1  17   8  11]
 [  0  14 424 187]
 [ 90  13 132 908]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.907852   0.610880   0.546548   0.564880    0.555202
Iteration 1    0.922082   0.658745   0.539640   0.522937    0.529425
Iteration 2    0.958335   0.613415   0.555027   0.559125    0.556419
Iteration 3    0.962944   0.666728   0.557372   0.495313    0.507237
Iteration 4    0.928134   0.653250   0.590407   0.537768    0.548294

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.642654   0.572426   0.676820   0.629950    0.648904
Iteration 1    0.677078   0.631316   0.647377   0.599567    0.610584
Iteration 2    0.669745   0.607318   0.646480   0.641509    0.638889
Iteration 3    0.690899   0.641055   0.613510   0.551633    0.573289
Iteration 4    0.663345   0.609059   0.637038   0.616928    0.615560

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.546793   0.584886   0.658161   0.643915    0.647371
Iteration 1    0.582890   0.640676   0.626288   0.658606    0.624508
Iteration 2    0.572459   0.595569   0.658671   0.615757    0.633798
Iteration 3    0.595554   0.606426   0.627397   0.635397    0.629840
Iteration 4    0.564908   0.620279   0.642538   0.629513    0.634598

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.508477   0.579002   0.654944   0.644460    0.648763
Iteration 1    0.534383   0.610752   0.625410   0.662850    0.638407
Iteration 2    0.519608   0.585093   0.668478   0.647263    0.656793
Iteration 3    0.545746   0.609586   0.633049   0.639584    0.634681
Iteration 4    0.518897   0.616717   0.655702   0.668652    0.661043

