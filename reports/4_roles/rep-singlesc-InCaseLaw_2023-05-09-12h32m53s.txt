RESULTS REPORT (SINGLE SENTENCE CLASSIFICATION)
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: test set (5 random seeds)
Max sequence length: 512
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Freeze layers: False
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 02h52m14s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    0.887235  0.004068  0.715904 0.015032   0.6181  0.0088   0.6283  0.0287   0.6057   0.0332
  2    0.718707  0.006297  0.718114 0.010147   0.6132  0.0091   0.6569  0.0106   0.6243   0.0110
  3    0.643667  0.004422  0.733768 0.003103   0.6098  0.0027   0.6619  0.0138   0.6278   0.0058
  4    0.587393  0.005477  0.744359 0.011273   0.6142  0.0058   0.6557  0.0079   0.6276   0.0080

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[296   3  39  54]
 [  1  23  10   3]
 [ 45   6 340 234]
 [105  12 211 815]]
Epoch 2:
[[299   3  35  55]
 [  1  27   5   4]
 [ 53  13 250 309]
 [ 97  17 141 888]]
Epoch 3:
[[289   2  36  65]
 [  1  26   8   2]
 [ 41  11 282 291]
 [ 91  14 186 852]]
Epoch 4:
[[262   3  43  84]
 [  1  26   6   4]
 [ 33  10 273 309]
 [ 66  16 170 891]]
=> Iteration 1:
Epoch 1:
[[257   4  61  70]
 [  1  24   9   3]
 [ 22   8 382 213]
 [ 74  13 235 821]]
Epoch 2:
[[261   3  44  84]
 [  1  26   7   3]
 [ 34  12 264 315]
 [ 72  14 130 927]]
Epoch 3:
[[271   3  59  59]
 [  1  26   5   5]
 [ 31  13 354 227]
 [ 90  17 216 820]]
Epoch 4:
[[268   3  48  73]
 [  1  26   5   5]
 [ 34  11 312 268]
 [ 84  14 174 871]]
=> Iteration 2:
Epoch 1:
[[247   3  42 100]
 [  0  25   6   6]
 [ 28  10 245 342]
 [ 63  15 105 960]]
Epoch 2:
[[289   2  46  55]
 [  1  25  10   1]
 [ 39  11 330 245]
 [ 92  15 183 853]]
Epoch 3:
[[311   2  32  47]
 [  1  27   5   4]
 [ 57  13 290 265]
 [119  15 158 851]]
Epoch 4:
[[275   2  39  76]
 [  1  25  10   1]
 [ 37  11 306 271]
 [ 78  14 163 888]]
=> Iteration 3:
Epoch 1:
[[ 252    3   17  120]
 [   1   25    5    6]
 [  28    8   97  492]
 [  72   14   43 1014]]
Epoch 2:
[[296   3  25  68]
 [  1  26   7   3]
 [ 58  11 195 361]
 [ 98  13 103 929]]
Epoch 3:
[[242   3  51  96]
 [  1  26   7   3]
 [ 29  11 288 297]
 [ 69  15 162 897]]
Epoch 4:
[[258   3  44  87]
 [  1  26   7   3]
 [ 37  11 267 310]
 [ 84  16 136 907]]
=> Iteration 4:
Epoch 1:
[[285   2  19  86]
 [  1  23   6   7]
 [ 41   6 126 452]
 [ 88  12  72 971]]
Epoch 2:
[[297   2  31  62]
 [  0  24   8   5]
 [ 46   7 256 316]
 [ 99  12 139 893]]
Epoch 3:
[[266   3  43  80]
 [  0  26   8   3]
 [ 38  10 299 278]
 [ 69  16 181 877]]
Epoch 4:
[[281   3  42  66]
 [  1  26   5   5]
 [ 42  10 295 278]
 [ 88  15 169 871]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.879723   0.711852   0.622119   0.658440    0.638343
Iteration 1    0.890566   0.705155   0.628367   0.658437    0.639811
Iteration 2    0.891122   0.696284   0.624966   0.634418    0.615974
Iteration 3    0.887566   0.736315   0.608492   0.590218    0.557135
Iteration 4    0.887198   0.729912   0.606789   0.599945    0.577210

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.713872   0.723270   0.600374   0.667347    0.620177
Iteration 1    0.714332   0.714742   0.618185   0.650486    0.623879
Iteration 2    0.730386   0.706960   0.619323   0.671801    0.640494
Iteration 3    0.714618   0.735219   0.604371   0.645645    0.607190
Iteration 4    0.720326   0.710379   0.623746   0.649295    0.629848

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.642438   0.738358   0.607578   0.659139    0.627019
Iteration 1    0.640217   0.733461   0.606670   0.669460    0.630515
Iteration 2    0.651199   0.735422   0.609534   0.682907    0.635151
Iteration 3    0.638809   0.728981   0.610767   0.641407    0.617589
Iteration 4    0.645671   0.732621   0.614338   0.656738    0.628652

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.586034   0.763106   0.610783   0.646849    0.620505
Iteration 1    0.582825   0.733504   0.617133   0.661901    0.633427
Iteration 2    0.597141   0.733081   0.623319   0.660927    0.636547
Iteration 3    0.581953   0.750129   0.606324   0.645398    0.615711
Iteration 4    0.589014   0.741976   0.613689   0.663392    0.631750

