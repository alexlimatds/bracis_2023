RESULTS REPORT - DFCSC-SEP
Model: InCaseLaw
Encoder: law-ai/InCaseLawBERT
Dataset: facts
Evaluation: test set (5 random seeds)
Max sequence length: 512
Min context length: 250
Batch size: 16
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 00h34m04s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    0.903793  0.024288  0.624867 0.016929   0.5788  0.0654   0.5683  0.0148   0.5603   0.0170
  2    0.648191  0.025007  0.604080 0.030827   0.6520  0.0237   0.6251  0.0361   0.6341   0.0314
  3    0.558701  0.020976  0.592697 0.026433   0.6583  0.0184   0.6600  0.0209   0.6571   0.0159
  4    0.508612  0.018137  0.598020 0.025017   0.6581  0.0161   0.6564  0.0203   0.6554   0.0157

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[298   0  52  42]
 [  1   4  23   9]
 [  0   1 506 118]
 [100   1 261 781]]
Epoch 2:
[[294   0  44  54]
 [  1  17  10   9]
 [  0  14 402 209]
 [ 88   5 130 920]]
Epoch 3:
[[286   0  47  59]
 [  1  15  13   8]
 [  0  12 447 166]
 [ 71   4 155 913]]
Epoch 4:
[[274   0  47  71]
 [  1  17   9  10]
 [  0  14 379 232]
 [ 71  10  95 967]]
=> Iteration 1:
Epoch 1:
[[321   0  32  39]
 [  1   0  31   5]
 [  0   0 488 137]
 [121   0 215 807]]
Epoch 2:
[[261   0  39  92]
 [  1  11  11  14]
 [  0  10 324 291]
 [ 60   7  84 992]]
Epoch 3:
[[280   1  50  61]
 [  1  17  11   8]
 [  0  16 450 159]
 [ 78  14 163 888]]
Epoch 4:
[[277   1  49  65]
 [  1  15  13   8]
 [  0  12 430 183]
 [ 75  12 140 916]]
=> Iteration 2:
Epoch 1:
[[266   0  46  80]
 [  1   0  24  12]
 [  0   0 446 179]
 [ 63   0 175 905]]
Epoch 2:
[[264   1  40  87]
 [  1  11  14  11]
 [  0  10 393 222]
 [ 63   9 118 953]]
Epoch 3:
[[280   1  51  60]
 [  1  11  19   6]
 [  0  10 424 191]
 [ 78   9 143 913]]
Epoch 4:
[[279   1  44  68]
 [  1  13  17   6]
 [  0  10 410 205]
 [ 75  10 140 918]]
=> Iteration 3:
Epoch 1:
[[303   0  46  43]
 [  1   0  28   8]
 [  0   0 502 123]
 [117   0 231 795]]
Epoch 2:
[[299   1  39  53]
 [  1  13  17   6]
 [  0  12 487 126]
 [ 79  11 143 910]]
Epoch 3:
[[284   1  43  64]
 [  1  19  11   6]
 [  0  16 422 187]
 [ 74  15 104 950]]
Epoch 4:
[[296   1  37  58]
 [  1  19  11   6]
 [  0  14 415 196]
 [ 74  14  96 959]]
=> Iteration 4:
Epoch 1:
[[297   0  39  56]
 [  1   0  25  11]
 [  0   0 456 169]
 [109   0 169 865]]
Epoch 2:
[[295   0  53  44]
 [  1   5  15  16]
 [  0   7 490 128]
 [118   6 218 801]]
Epoch 3:
[[290   1  41  60]
 [  1  17  10   9]
 [  0  16 426 183]
 [ 92  14 162 875]]
Epoch 4:
[[280   1  53  58]
 [  1  17  10   9]
 [  0  16 433 176]
 [ 90  14 176 863]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.867157   0.616691   0.709147   0.590300    0.593916
Iteration 1    0.923544   0.622203   0.544621   0.576429    0.556977
Iteration 2    0.910603   0.614242   0.555265   0.545987    0.548791
Iteration 3    0.885166   0.613064   0.540551   0.567924    0.549836
Iteration 4    0.932495   0.658136   0.544302   0.561008    0.552109

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.637382   0.583438   0.674416   0.664390    0.669096
Iteration 1    0.646727   0.626748   0.656256   0.587351    0.612866
Iteration 2    0.641981   0.604687   0.650979   0.608334    0.626569
Iteration 3    0.620029   0.559131   0.670308   0.672364    0.670784
Iteration 4    0.694838   0.646397   0.607923   0.593118    0.591184

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.543987   0.575932   0.688666   0.662243    0.674053
Iteration 1    0.554224   0.609493   0.649366   0.667662    0.656175
Iteration 2    0.552301   0.592279   0.645186   0.622190    0.632651
Iteration 3    0.543257   0.554616   0.669574   0.686087    0.674267
Iteration 4    0.599737   0.631168   0.638603   0.661596    0.648341

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.500273   0.596380   0.669276   0.652715    0.658226
Iteration 1    0.513566   0.609758   0.655413   0.650359    0.652191
Iteration 2    0.499660   0.595338   0.651554   0.630559    0.640308
Iteration 3    0.488375   0.555879   0.680696   0.692909    0.683995
Iteration 4    0.541184   0.632744   0.633380   0.655394    0.642273

