RESULTS REPORT - Cohan
Model: Longformer
Encoder: allenai/longformer-base-4096
Dataset: facts
Chunk layout: Cohan
Evaluation: test set (5 random seeds)
Max sequence length: 1024
Max sentence length: 85
Max sentences per chunk: 14
Batch size: 4
Dropout rate: 0.2
Learning rate: 1e-05
Adam Epsilon: 1e-08
Weight decay: 0.001
Train time: 01h29m40s
GPU name: Tesla V100-SXM2-16GB
GPU memory: 15.78

Averages:
Epoch Train loss   std    Test loss   std    P (macro) P std  R (macro) R std  F1 (macro) F1 std
  1    1.013113  0.016424  0.764041 0.044574   0.6004  0.0887   0.4646  0.0553   0.4576   0.0649
  2    0.773175  0.016313  0.683033 0.034131   0.6439  0.0303   0.6187  0.0133   0.6173   0.0220
  3    0.643603  0.012185  0.666200 0.038078   0.6595  0.0179   0.6276  0.0187   0.6365   0.0186
  4    0.556419  0.007117  0.648947 0.017346   0.6712  0.0162   0.6408  0.0056   0.6532   0.0080

*** Detailed report ***

Confusion matrices
------------------
Fact: 0 
RulingByPresentCourt: 1 
RatioOfTheDecision: 2 
Other: 3 
=> Iteration 0:
Epoch 1:
[[ 206    0    1  185]
 [   0    0    0   37]
 [   0    0   29  596]
 [  20    0    0 1123]]
Epoch 2:
[[295   0  30  67]
 [  1  13   6  17]
 [ 19   6 366 234]
 [ 77   8  87 971]]
Epoch 3:
[[318   0  21  53]
 [  5   9   5  18]
 [ 20   9 305 291]
 [111   6  79 947]]
Epoch 4:
[[280   0  51  61]
 [  2  15   9  11]
 [ 11   9 406 199]
 [ 76   7 118 942]]
=> Iteration 1:
Epoch 1:
[[ 246    0    4  142]
 [   2    1    0   34]
 [   1    0   17  607]
 [  47    0    5 1091]]
Epoch 2:
[[314   0  40  38]
 [  5  14  13   5]
 [ 21  14 389 201]
 [148  10 148 837]]
Epoch 3:
[[286   0  53  53]
 [  4  11  19   3]
 [  8   5 491 121]
 [ 73   6 188 876]]
Epoch 4:
[[291   0  42  59]
 [  4  12  13   8]
 [  9   6 403 207]
 [ 81   5 107 950]]
=> Iteration 2:
Epoch 1:
[[222   0  49 121]
 [  0   0  24  13]
 [  1   0 458 166]
 [ 41   0 278 824]]
Epoch 2:
[[263   0  72  57]
 [  1   9  19   8]
 [  1   5 466 153]
 [ 76   3 212 852]]
Epoch 3:
[[308   0  40  44]
 [  5  12  11   9]
 [ 13   8 352 252]
 [ 91   6 106 940]]
Epoch 4:
[[288   0  63  41]
 [  2  12  15   8]
 [  8   6 427 184]
 [ 85   7 142 909]]
=> Iteration 3:
Epoch 1:
[[ 244    0   13  135]
 [   1    0    7   29]
 [   0    0  290  335]
 [  44    0   89 1010]]
Epoch 2:
[[294   2  45  51]
 [  1  16  12   8]
 [  6  14 259 346]
 [ 96  14  71 962]]
Epoch 3:
[[268   2  56  66]
 [  3  15  10   9]
 [  1  11 398 215]
 [ 71  14 114 944]]
Epoch 4:
[[279   2  54  57]
 [  4  15  10   8]
 [  7  11 385 222]
 [ 81  14 106 942]]
=> Iteration 4:
Epoch 1:
[[263   0  58  71]
 [  1   0  33   3]
 [  4   0 542  79]
 [ 71   0 417 655]]
Epoch 2:
[[291   0   8  93]
 [  3  21   3  10]
 [ 17  19 171 418]
 [ 84  14  46 999]]
Epoch 3:
[[304   0  49  39]
 [  4  12  16   5]
 [ 14   6 469 136]
 [ 99   6 232 806]]
Epoch 4:
[[289   0  44  59]
 [  4  16  10   7]
 [ 10   8 379 228]
 [ 81   8 129 925]]

Scores
------
Epoch: 1
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    1.012298   0.813689   0.614185   0.388603    0.370873
Iteration 1    1.001525   0.794151   0.766776   0.409071    0.385803
Iteration 2    0.994684   0.749365   0.535034   0.505009    0.510638
Iteration 3    1.014404   0.685513   0.560106   0.492522    0.511172
Iteration 4    1.042652   0.777487   0.525661   0.527793    0.509544

Epoch: 2
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.753254   0.630888   0.683949   0.634755    0.653603
Iteration 1    0.769376   0.719568   0.611367   0.633521    0.619999
Iteration 2    0.759289   0.654813   0.675729   0.601292    0.622377
Iteration 3    0.788863   0.702330   0.615340   0.609619    0.602295
Iteration 4    0.795093   0.707566   0.633209   0.614383    0.588069

Epoch: 3
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.623469   0.739272   0.635699   0.592747    0.602164
Iteration 1    0.645635   0.654428   0.689148   0.644723    0.658508
Iteration 2    0.637800   0.638739   0.661680   0.623909    0.637617
Iteration 3    0.658147   0.634365   0.648014   0.637944    0.641239
Iteration 4    0.652963   0.664198   0.662952   0.638849    0.643197

Epoch: 4
             Train loss  Test loss  P (macro)  R (macro)  F1 (macro)
Iteration 0    0.550280   0.620968   0.678618   0.648360    0.662085
Iteration 1    0.551495   0.666315   0.691750   0.635654    0.657262
Iteration 2    0.553144   0.642660   0.671975   0.634373    0.649332
Iteration 3    0.557351   0.646498   0.642334   0.639322    0.639470
Iteration 4    0.569826   0.668296   0.671450   0.646338    0.657608

